***************
** Arguments **
***************
backbone: 
calibration: False
config_file: configs/trainers/CoOp/rn50.yaml
cutrate: None
dataset_config_file: configs/datasets/eurosat.yaml
eval_only: True
head: 
load_epoch: None
model_dir: 
no_train: False
opts: []
output_dir: output/ZeroshotCLIP3/rn50/eurosat
relevance_refine: False
resume: 
root: /ix/yufeihuang/jia/nlp/prompt/data
seed: -1
source_domains: None
target_domains: None
trainer: ZeroshotCLIP3
transforms: None
vb_dir: /ihome/yufeihuang/jiy130/Prompt/CoOp/knowledgebase
vbsize: 40
verbalizer: True
************
** Config **
************
CALIBRATION: False
CALIBRATION_CUT: 0
DATALOADER:
  K_TRANSFORMS: 1
  NUM_WORKERS: 8
  RETURN_IMG0: False
  TEST:
    BATCH_SIZE: 100
    SAMPLER: SequentialSampler
  TRAIN_U:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAME_AS_X: True
    SAMPLER: RandomSampler
  TRAIN_X:
    BATCH_SIZE: 32
    N_DOMAIN: 0
    N_INS: 16
    SAMPLER: RandomSampler
DATASET:
  ALL_AS_UNLABELED: False
  CIFAR_C_LEVEL: 1
  CIFAR_C_TYPE: 
  NAME: EuroSAT
  NUM_LABELED: -1
  NUM_SHOTS: -1
  ROOT: /ix/yufeihuang/jia/nlp/prompt/data
  SOURCE_DOMAINS: ()
  STL10_FOLD: -1
  SUBSAMPLE_CLASSES: all
  TARGET_DOMAINS: ()
  VAL_PERCENT: 0.1
INPUT:
  COLORJITTER_B: 0.4
  COLORJITTER_C: 0.4
  COLORJITTER_H: 0.1
  COLORJITTER_S: 0.4
  CROP_PADDING: 4
  CUTOUT_LEN: 16
  CUTOUT_N: 1
  GB_K: 21
  GB_P: 0.5
  GN_MEAN: 0.0
  GN_STD: 0.15
  INTERPOLATION: bicubic
  NO_TRANSFORM: False
  PIXEL_MEAN: [0.48145466, 0.4578275, 0.40821073]
  PIXEL_STD: [0.26862954, 0.26130258, 0.27577711]
  RANDAUGMENT_M: 10
  RANDAUGMENT_N: 2
  RGS_P: 0.2
  RRCROP_SCALE: (0.08, 1.0)
  SIZE: (224, 224)
  TRANSFORMS: ('random_resized_crop', 'random_flip', 'normalize')
MODEL:
  BACKBONE:
    NAME: RN50
    PRETRAINED: True
  HEAD:
    ACTIVATION: relu
    BN: True
    DROPOUT: 0.0
    HIDDEN_LAYERS: ()
    NAME: 
  INIT_WEIGHTS: 
OPTIM:
  ADAM_BETA1: 0.9
  ADAM_BETA2: 0.999
  BASE_LR_MULT: 0.1
  GAMMA: 0.1
  LR: 0.002
  LR_SCHEDULER: cosine
  MAX_EPOCH: 200
  MOMENTUM: 0.9
  NAME: sgd
  NEW_LAYERS: ()
  RMSPROP_ALPHA: 0.99
  SGD_DAMPNING: 0
  SGD_NESTEROV: False
  STAGED_LR: False
  STEPSIZE: (-1,)
  WARMUP_CONS_LR: 1e-05
  WARMUP_EPOCH: 1
  WARMUP_MIN_LR: 1e-05
  WARMUP_RECOUNT: True
  WARMUP_TYPE: constant
  WEIGHT_DECAY: 0.0005
OUTPUT_DIR: output/ZeroshotCLIP3/rn50/eurosat
RELEVANCE_REFINE: False
RESUME: 
SEED: -1
TEST:
  COMPUTE_CMAT: False
  EVALUATOR: Classification
  FINAL_MODEL: last_step
  NO_TEST: False
  PER_CLASS_RESULT: False
  SPLIT: test
TRAIN:
  CHECKPOINT_FREQ: 0
  COUNT_ITER: train_x
  PRINT_FREQ: 5
TRAINER:
  CDAC:
    CLASS_LR_MULTI: 10
    P_THRESH: 0.95
    RAMPUP_COEF: 30
    RAMPUP_ITRS: 1000
    STRONG_TRANSFORMS: ()
    TOPK_MATCH: 5
  COCOOP:
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  COOP:
    CLASS_TOKEN_POSITION: end
    CSC: False
    CTX_INIT: 
    N_CTX: 16
    PREC: fp16
  CROSSGRAD:
    ALPHA_D: 0.5
    ALPHA_F: 0.5
    EPS_D: 1.0
    EPS_F: 1.0
  DAEL:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DAELDG:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 0.5
  DDAIG:
    ALPHA: 0.5
    CLAMP: False
    CLAMP_MAX: 1.0
    CLAMP_MIN: -1.0
    G_ARCH: 
    LMDA: 0.3
    WARMUP: 0
  DOMAINMIX:
    ALPHA: 1.0
    BETA: 1.0
    TYPE: crossdomain
  ENTMIN:
    LMDA: 0.001
  FIXMATCH:
    CONF_THRE: 0.95
    STRONG_TRANSFORMS: ()
    WEIGHT_U: 1.0
  M3SDA:
    LMDA: 0.5
    N_STEP_F: 4
  MCD:
    N_STEP_F: 4
  MEANTEACHER:
    EMA_ALPHA: 0.999
    RAMPUP: 5
    WEIGHT_U: 1.0
  MIXMATCH:
    MIXUP_BETA: 0.75
    RAMPUP: 20000
    TEMP: 2.0
    WEIGHT_U: 100.0
  MME:
    LMDA: 0.1
  NAME: ZeroshotCLIP3
  SE:
    CONF_THRE: 0.95
    EMA_ALPHA: 0.999
    RAMPUP: 300
USE_CUDA: True
VERBALIZER:
  DIR: /ihome/yufeihuang/jiy130/Prompt/CoOp/knowledgebase/EuroSAT
  SIZE: 40
VERBOSE: True
VERSION: 1
Collecting env info ...
** System info **
PyTorch version: 1.13.1
Is debug build: False
CUDA used to build PyTorch: 11.7
ROCM used to build PyTorch: N/A

OS: Red Hat Enterprise Linux (x86_64)
GCC version: (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44)
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.17

Python version: 3.8.16 (default, Jan 17 2023, 23:13:24)  [GCC 11.2.0] (64-bit runtime)
Python platform: Linux-3.10.0-1160.71.1.el7.x86_64-x86_64-with-glibc2.17
Is CUDA available: True
CUDA runtime version: Could not collect
CUDA_MODULE_LOADING set to: LAZY
GPU models and configuration: 
GPU 0: NVIDIA A100-PCIE-40GB
GPU 1: NVIDIA A100-PCIE-40GB
GPU 2: NVIDIA A100-PCIE-40GB
GPU 3: NVIDIA A100-PCIE-40GB

Nvidia driver version: 515.65.01
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] numpy==1.23.5
[pip3] torch==1.13.1
[pip3] torchaudio==0.13.1
[pip3] torchvision==0.14.1
[conda] blas                      1.0                         mkl  
[conda] cudatoolkit               11.3.1               h2bc3f7f_2  
[conda] ffmpeg                    4.3                  hf484d3e_0    pytorch
[conda] mkl                       2021.4.0           h06a4308_640  
[conda] mkl-service               2.4.0            py38h7f8727e_0  
[conda] mkl_fft                   1.3.1            py38hd3c417c_0  
[conda] mkl_random                1.2.2            py38h51133e4_0  
[conda] numpy                     1.23.5           py38h14f4228_0  
[conda] numpy-base                1.23.5           py38h31eccc5_0  
[conda] pytorch                   1.13.1          py3.8_cuda11.7_cudnn8.5.0_0    pytorch
[conda] pytorch-cuda              11.7                 h778d358_3    pytorch
[conda] pytorch-mutex             1.0                        cuda    pytorch
[conda] torchaudio                0.13.1               py38_cu117    pytorch
[conda] torchvision               0.14.1               py38_cu117    pytorch
        Pillow (9.4.0)

Loading trainer: ZeroshotCLIP3
Loading dataset: EuroSAT
Reading split from /ix/yufeihuang/jia/nlp/prompt/data/eurosat/split_zhou_EuroSAT.json
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  -------
Dataset    EuroSAT
# classes  10
# train_x  13,500
# val      5,400
# test     8,100
---------  -------
['Annual Crop Land', 'Forest', 'Herbaceous Vegetation Land', 'Highway or Road', 'Industrial Buildings', 'Pasture Land', 'Permanent Crop Land', 'Residential Buildings', 'River', 'Sea or Lake']
Loading CLIP (backbone: RN50)
Prompts: ['a centered satellite photo of annual crop land.', 'a centered satellite photo of forest.', 'a centered satellite photo of forward.', 'a centered satellite photo of front.', 'a centered satellite photo of bow.', 'a centered satellite photo of foremost.', 'a centered satellite photo of stem.', 'a centered satellite photo of prow.', 'a centered satellite photo of anterior.', 'a centered satellite photo of aft.', 'a centered satellite photo of nose.', 'a centered satellite photo of lateral.', 'a centered satellite photo of forefront.', 'a centered satellite photo of seafaring.', 'a centered satellite photo of sailing.', 'a centered satellite photo of navigation.', 'a centered satellite photo of watercraft.', 'a centered satellite photo of vessel.', 'a centered satellite photo of frontline.', 'a centered satellite photo of frontal.', 'a centered satellite photo of frontward.', 'a centered satellite photo of forepart.', 'a centered satellite photo of starboard.', 'a centered satellite photo of facade.', 'a centered satellite photo of frontwise.', 'a centered satellite photo of vanward.', 'a centered satellite photo of hind.', 'a centered satellite photo of fa√ßade.', 'a centered satellite photo of superstructure.', 'a centered satellite photo of nostrils.', 'a centered satellite photo of wings.', 'a centered satellite photo of cowl.', 'a centered satellite photo of fuselage.', 'a centered satellite photo of inboard.', 'a centered satellite photo of conning.', 'a centered satellite photo of rails.', 'a centered satellite photo of frontage.', 'a centered satellite photo of tail.', 'a centered satellite photo of shoulders.', 'a centered satellite photo of shorefront.', 'a centered satellite photo of claws.', 'a centered satellite photo of tailplane.', 'a centered satellite photo of herbaceous vegetation land.', 'a centered satellite photo of highway or road.', 'a centered satellite photo of industrial buildings.', 'a centered satellite photo of industrial sector.', 'a centered satellite photo of industrial revolution.', 'a centered satellite photo of british industrial architecture.', 'a centered satellite photo of modern architecture.', 'a centered satellite photo of pasture land.', 'a centered satellite photo of permanent crop land.', 'a centered satellite photo of residential buildings.', 'a centered satellite photo of zoning.', 'a centered satellite photo of subdivision.', 'a centered satellite photo of houses.', 'a centered satellite photo of rural.', 'a centered satellite photo of deed.', 'a centered satellite photo of industrial district.', 'a centered satellite photo of commercial area.', 'a centered satellite photo of single-family housing.', 'a centered satellite photo of multi-family residential.', 'a centered satellite photo of mobile home.', 'a centered satellite photo of house.', 'a centered satellite photo of urban density.', 'a centered satellite photo of bespoke.', 'a centered satellite photo of floor area ratio.', 'a centered satellite photo of mansion.', 'a centered satellite photo of land development.', 'a centered satellite photo of tenement.', 'a centered satellite photo of transport infrastructure.', 'a centered satellite photo of restrictive covenant.', 'a centered satellite photo of speculation.', 'a centered satellite photo of shantytown.', 'a centered satellite photo of concentric zone model.', 'a centered satellite photo of urban geography.', 'a centered satellite photo of real estate development.', 'a centered satellite photo of real property.', 'a centered satellite photo of streetcar suburb.', 'a centered satellite photo of lifestyle.', 'a centered satellite photo of elevation.', 'a centered satellite photo of street.', 'a centered satellite photo of suburb.', 'a centered satellite photo of stereotype.', 'a centered satellite photo of single-family house.', 'a centered satellite photo of kaizen.', 'a centered satellite photo of middle class.', 'a centered satellite photo of mortgage loan.', 'a centered satellite photo of cul-de-sac.', 'a centered satellite photo of middle-class.', 'a centered satellite photo of post‚Äìworld war ii economic expansion.', 'a centered satellite photo of new york city.', 'a centered satellite photo of los angeles.', 'a centered satellite photo of river.', 'a centered satellite photo of estuary.', 'a centered satellite photo of lake.', 'a centered satellite photo of stream.', 'a centered satellite photo of water.', 'a centered satellite photo of billabong.', 'a centered satellite photo of rapids.', 'a centered satellite photo of waterfall.', 'a centered satellite photo of floodplain.', 'a centered satellite photo of sea.', 'a centered satellite photo of channel.', 'a centered satellite photo of brahmaputra.', 'a centered satellite photo of ocean.', 'a centered satellite photo of confluence.', 'a centered satellite photo of watercourse.', 'a centered satellite photo of euphrates.', 'a centered satellite photo of brazos.', 'a centered satellite photo of klamath.', 'a centered satellite photo of dnieper.', 'a centered satellite photo of nile.', 'a centered satellite photo of creek.', 'a centered satellite photo of danube.', 'a centered satellite photo of tributary.', 'a centered satellite photo of amazon river.', 'a centered satellite photo of brook.', 'a centered satellite photo of mekong.', 'a centered satellite photo of downstream.', 'a centered satellite photo of valley.', 'a centered satellite photo of canal.', 'a centered satellite photo of pond.', 'a centered satellite photo of ganges river.', 'a centered satellite photo of mekong river.', 'a centered satellite photo of danube river.', 'a centered satellite photo of tunguska.', 'a centered satellite photo of angara.', 'a centered satellite photo of adige.', 'a centered satellite photo of arno.', 'a centered satellite photo of colorado.', 'a centered satellite photo of james.', 'a centered satellite photo of avon.', 'a centered satellite photo of ebro.', 'a centered satellite photo of sea or lake.']
text feature size: torch.Size([134, 1024])
Loading evaluator: Classification
Note that load_model() is skipped as no pretrained model is given (ignore this if it's done on purpose)
Evaluate on the *test* set
=> result
* total: 8,100
* correct: 2,835
* accuracy: 35.0%
* error: 65.0%
* macro_f1: 32.0%
